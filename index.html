<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Daurah Remaja MKSLB</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f4f7f6; color: #333; }
        .hero { background: linear-gradient(135deg, #1e5128, #4e944f); color: white; padding: 40px 20px; text-align: center; border-radius: 0 0 40px 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .logo-container { background: white; width: 100px; height: 100px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.1); overflow: hidden; }
        .logo-container img { width: 80%; height: auto; }
        .card-custom { border: none; border-radius: 20px; box-shadow: 0 6px 20px rgba(0,0,0,0.08); margin-bottom: 25px; background: white; }
        .btn-success { background-color: #4e944f; border: none; border-radius: 12px; padding: 12px; }
        .btn-success:hover { background-color: #1e5128; }
        .form-select, .form-control { border-radius: 12px; padding: 12px; border: 1px solid #ddd; }
    </style>
</head>
<body>

    <div class="hero">
        <div class="logo-container">
            <img src="logo.png" alt="Logo MKSLB" onerror="this.src='https://via.placeholder.com/80?text=MKSLB'">
        </div>
        <h1 class="fw-bold">ðŸŒ™ Daurah Remaja Quranic</h1>
        <p class="lead">Masjid Kampung Sungai Lang Baru (MKSLB)</p>
        <div class="badge bg-warning text-dark px-3 py-2">MODUL IHYA RAMADHAN 1447H / 2026M</div>
    </div>

    <div class="container mt-5">
        <div class="row text-center mb-4">
            <div class="col-md-4 mb-3">
                <div class="card card-custom p-3">
                    <h6 class="text-muted small text-uppercase">Peserta Berdaftar</h6>
                    <h3 class="fw-bold text-success">45</h3>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card card-custom p-3">
                    <h6 class="text-muted small text-uppercase">Status Sistem</h6>
                    <h3 class="fw-bold text-primary">ONLINE</h3>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card card-custom p-3">
                    <h6 class="text-muted small text-uppercase">Hujung Minggu Ke-</h6>
                    <h3 class="fw-bold text-danger">#1 / 4</h3>
                </div>
            </div>
        </div>

        <div class="card card-custom p-4">
            <h5 class="fw-bold mb-3 text-success">Update Progress Hafazan (Mentor)</h5>
            <form id="updateForm">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label small fw-bold">Pilih Peserta</label>
                        <select class="form-select" id="namaPeserta">
                            <option value="" disabled selected>Cari nama...</option>
                            <option>AHMAD NAZHAN BIN AZMI</option>
                            <option>MUHAMMAD NAUFAL HAZIQ BIN MOHD AL HAKIM</option>
                            <option>MUHAMMAD AZIQ DANIEL BIN MOHD KHAIRIL</option>
                            <option>MUHAMMAD AMIR RASYIDI BIN SHAMSUDDIN</option>
                            <option>MUHAMMAD DANEAL HAFIZ BIN MOHD HAFIZUDIN</option>
                            <option>MUHAMMAD AQIL RAYYAN BIN MOHD SYUKRI</option>
                            <option>MUHAMMAD HARITH IRFAN BIN AZLAN</option>
                            <option>MUHAMMAD DANISH ISKANDAR BIN MOHD ADLI</option>
                            <option>MUHAMMAD SYAHMI BIN MOHD SHUKRI</option>
                            <option>MUHAMMAD AIMAN HAKIM BIN ABDULLAH</option>
                            <option>MUHAMMAD IRFAN BIN MOHD ZAIREE</option>
                            <option>NUR IMANINA BINTI MOHD FAUZI</option>
                            <option>NURUL IZZAH BINTI KHAIRUL ANUAR</option>
                        </select>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label small fw-bold">Tahap Silibus</label>
                        <select class="form-select" id="tahap" onchange="updateSurahList()">
                            <option value="" disabled selected>Pilih Tahap...</option>
                            <option value="Tahap 1">Tahap 1 (Surah Lazim: Al-Fil - An-Naas)</option>
                            <option value="Tahap 2">Tahap 2 (Ad-Dhuha - Al-Bayyinah)</option>
                            <option value="Tahap 3">Tahap 3 (Al-Ghaasyiah - At-Tariq)</option>
                            <option value="Tahap 4">Tahap 4 (Abasa - Al-Buruj)</option>
                            <option value="Tahap 5">Tahap 5 (Al-Fajr - An-Naba')</option>
                        </select>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label small fw-bold">Surah Terakhir Dicapai</label>
                        <select class="form-select" id="surahTerakhir">
                            <option value="" disabled selected>Pilih Tahap Dahulu...</option>
                        </select>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label small fw-bold">% Kemajuan</label>
                        <select class="form-select" id="progressInput">
                            <option value="0">0% (Baru Mula)</option>
                            <option value="20">20%</option>
                            <option value="40">40%</option>
                            <option value="60">60%</option>
                            <option value="80">80%</option>
                            <option value="100">100% (Selesai Tahap)</option>
                        </select>
                    </div>
                </div>
                <button type="button" id="submitBtn" class="btn btn-success w-100 fw-bold shadow-sm" onclick="submitData()">Simpan Rekod & Update Database</button>
            </form>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-3 mt-5">
            <h5 class="fw-bold m-0">Live Progress Dashboard (Preview)</h5>
            <span class="badge bg-dark px-3 py-2">Real-Time Data</span>
        </div>

        <div id="dashboardList">
            <div class="alert alert-info text-center rounded-pill">
                Mentor: Sila kemaskini hafazan peserta di atas. Data akan disimpan terus ke Google Sheet MKSLB.
            </div>
        </div>
    </div>

    <footer class="text-center my-5 text-muted pb-4">
        <hr class="container">
        <p class="mb-1">Â© 2026 Jawatankuasa Daurah Remaja MKSLB</p>
        <small>Sistem Pengurusan Digital Ihya Ramadhan</small>
    </footer>

    <script>
        // Data Surah mengikut Tahap
        const surahData = {
            "Tahap 1": ["Al-Fil", "Quraisy", "Al-Ma'un", "Al-Kauthar", "Al-Kafirun", "An-Nasr", "Al-Masad", "Al-Ikhlas", "Al-Falaq", "An-Nas"],
            "Tahap 2": ["Ad-Dhuha", "Asy-Syarh", "At-Tin", "Al-'Alaq", "Al-Qadr", "Al-Bayyinah", "Az-Zalzalah", "Al-'Adiyat", "Al-Qari'ah", "At-Takathur"],
            "Tahap 3": ["Al-Ghaasyiah", "Al-Balad", "Al-Infithar", "Al-A'laa", "Al-Lail", "Asy-Syams", "At-Tariq"],
            "Tahap 4": ["Abasa", "At-Takwir", "Al-Insyiqaq", "Al-Buruj"],
            "Tahap 5": ["Al-Fajr", "Al-Muthoffifin", "An-Naba'", "An-Nazi'at"]
        };

        // Fungsi untuk kemaskini senarai surah bila Tahap dipilih
        function updateSurahList() {
            const tahap = document.getElementById('tahap').value;
            const surahSelect = document.getElementById('surahTerakhir');
            surahSelect.innerHTML = '<option value="" disabled selected>Pilih Surah...</option>';
            
            if (surahData[tahap]) {
                surahData[tahap].forEach(s => {
                    let opt = document.createElement('option');
                    opt.value = s;
                    opt.text = s;
                    surahSelect.add(opt);
                });
            }
        }

        async function submitData() {
            const btn = document.getElementById('submitBtn');
            const nama = document.getElementById('namaPeserta').value;
            const progress = document.getElementById('progressInput').value;
            const tahap = document.getElementById('tahap').value;
            const surah = document.getElementById('surahTerakhir').value;
            
            const webAppUrl = "https://script.google.com/macros/s/AKfycbwTRWmkTTxKmQiR6WJyb0aX2VUxxgP5sxqsaz_8atpa554PSAjnSnO9JcnFz-nt46k/exec"; 

            if(!nama || !tahap || !surah) {
                alert("Sila lengkapkan semua maklumat.");
                return;
            }

            btn.disabled = true;
            btn.innerText = "Sedang Menyimpan...";

            const data = {
                nama: nama,
                tahap: tahap,
                progress: progress,
                surah: surah
            };

            try {
                await fetch(webAppUrl, {
                    method: 'POST',
                    mode: 'no-cors', 
                    cache: 'no-cache',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                alert("Alhamdulillah! Rekod " + nama + " berjaya disimpan.");
                document.getElementById('updateForm').reset();
                document.getElementById('surahTerakhir').innerHTML = '<option value="" disabled selected>Pilih Tahap Dahulu...</option>';
            } catch (error) {
                alert("Ralat teknikal. Sila periksa sambungan internet.");
            } finally {
                btn.disabled = false;
                btn.innerText = "Simpan Rekod & Update Database";
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
